import{j as t}from"./jsx-runtime.3a2d0367.js";import{r as a}from"./index.b2a7ed32.js";import{J as R}from"./jszip.min.9732e024.js";import{L as S}from"./LoadingSpinner.d3c04f9a.js";import{u as Z}from"./utils.b058de7b.js";import"./_commonjs-dynamic-modules.23156833.js";const U=({lang:D})=>{const s=Z(D),[j,d]=a.useState(null),[g,l]=a.useState([]),[i,u]=a.useState(!1),[h,c]=a.useState(null),[k,p]=a.useState(!1),f=a.useRef(null),v=e=>{if(e===0)return"0 Bytes";const r=1024,o=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(r));return parseFloat((e/Math.pow(r,n)).toFixed(2))+" "+o[n]},y=a.useCallback(async e=>{if(e.type!=="application/zip"&&!e.name.endsWith(".zip")){c(s("components.fileDecompressor.errorInvalidZip")),d(null),l([]);return}d(e),u(!0),c(null),l([]);try{const o=await new R().loadAsync(e),n=[];for(const b in o.files){const m=o.files[b],x=m.dir?null:await m.async("blob");n.push({name:b,isDirectory:m.dir,size:x?x.size:0,blob:x})}l(n)}catch{c(s("components.fileDecompressor.errorReadingZip"))}finally{u(!1)}},[s]),N=e=>{const r=e.target.files?.[0];r&&y(r)},w=e=>{e.preventDefault(),e.stopPropagation(),p(!1);const r=e.dataTransfer.files?.[0];r&&y(r)},z=e=>{e.preventDefault(),e.stopPropagation(),p(!0)},L=e=>{e.preventDefault(),e.stopPropagation(),p(!1)},C=e=>{if(e.blob&&!e.isDirectory){const r=URL.createObjectURL(e.blob),o=document.createElement("a");o.href=r,o.download=e.name.split("/").pop()||"arquivo",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}},F=()=>{d(null),l([]),c(null)};return t.jsxs("div",{className:"relative bg-white p-6 rounded-lg shadow-md dark:bg-gray-800",children:[i&&t.jsx(S,{text:s("components.fileDecompressor.readingZip")}),t.jsx("input",{type:"file",accept:".zip,application/zip",onChange:N,className:"hidden",ref:f,disabled:i}),!j&&t.jsxs("div",{onDrop:w,onDragOver:z,onDragLeave:L,className:`flex flex-col items-center justify-center p-10 border-2 border-dashed rounded-lg transition-colors ${k?"border-purple-600 bg-purple-50 dark:bg-gray-700":"border-gray-300 dark:border-gray-600"}`,children:[t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:s("components.fileDecompressor.dragAndDrop")}),t.jsx("button",{onClick:()=>f.current?.click(),disabled:i,className:"w-auto bg-purple-600 text-white font-bold py-2 px-4 rounded-md hover:bg-purple-700 transition-colors disabled:bg-purple-400 dark:disabled:bg-purple-800",children:s("components.fileDecompressor.selectZip")})]}),h&&t.jsx("p",{className:"mt-4 text-center text-red-500",children:h}),g.length>0&&t.jsxs("div",{className:`mt-6 ${i?"opacity-20":""}`,children:[t.jsx("h2",{className:"text-xl font-semibold mb-2 dark:text-gray-200",children:s("components.fileDecompressor.fileContents")}),t.jsx("div",{className:"border rounded-lg dark:border-gray-600 max-h-96 overflow-y-auto",children:t.jsxs("table",{className:"w-full text-left",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"p-3 text-sm font-semibold text-gray-600 dark:text-gray-300",children:s("components.fileDecompressor.fileName")}),t.jsx("th",{className:"p-3 text-sm font-semibold text-gray-600 dark:text-gray-300",children:s("components.fileDecompressor.size")}),t.jsx("th",{className:"p-3 text-sm font-semibold text-gray-600 dark:text-gray-300",children:s("components.fileDecompressor.action")})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:g.map(e=>t.jsxs("tr",{children:[t.jsx("td",{className:"p-3 text-sm text-gray-800 dark:text-gray-200",children:e.name}),t.jsx("td",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:e.isDirectory?s("components.fileDecompressor.folder"):v(e.size)}),t.jsx("td",{className:"p-3",children:!e.isDirectory&&t.jsx("button",{onClick:()=>C(e),className:"text-blue-500 hover:underline text-sm",children:s("components.fileDecompressor.download")})})]},e.name))})]})}),t.jsx("button",{onClick:F,className:"w-full mt-4 text-sm text-gray-500 hover:text-purple-600 dark:text-gray-400 dark:hover:text-purple-400",children:s("components.fileDecompressor.selectAnother")})]})]})};export{U as default};
