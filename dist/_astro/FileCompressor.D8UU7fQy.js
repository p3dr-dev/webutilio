import{j as t}from"./jsx-runtime.D3GSbgeI.js";import{r as o}from"./index.yGrMsBkE.js";import{J as E}from"./jszip.min.BEB7njDc.js";import{L as M}from"./LoadingSpinner.Dvz2bPl4.js";import{u as T}from"./utils.BtV3MdL8.js";import"./index.yBjzXJbu.js";import"./_commonjsHelpers.Cpj98o6Y.js";const K=({lang:k})=>{const s=T(k),[a,u]=o.useState([]),[g,C]=o.useState("zip"),[c,f]=o.useState(!1),[x,l]=o.useState(""),[h,d]=o.useState(null),[F,p]=o.useState(null),[v,b]=o.useState(""),[w,m]=o.useState(!1),y=o.useRef(null),S=d,z=p,j=e=>{e&&e.length>0&&(u(r=>[...r,...Array.from(e)]),S(null),z(null),l(""))},D=e=>{j(e.target.files)},B=e=>{e.preventDefault(),e.stopPropagation(),m(!1),j(e.dataTransfer.files)},L=e=>{e.preventDefault(),e.stopPropagation(),m(!0)},O=e=>{e.preventDefault(),e.stopPropagation(),m(!1)},N=e=>{if(e===null||e===0)return"0 Bytes";const r=1024,n=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(e)/Math.log(r));return parseFloat((e/Math.pow(r,i)).toFixed(2))+" "+n[i]},P=async()=>{if(!a||a.length===0){l(s("components.fileCompressor.errorNoFiles"));return}f(!0),l(""),d(null),p(null);try{let e;if(g==="zip"){const r=new E;for(let n=0;n<a.length;n++){const i=a[n];r.file(i.name,i)}e=await r.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:9}}),b(s("components.fileCompressor.downloadNameZip"))}d(URL.createObjectURL(e)),p(e.size)}catch(e){l(`${s("components.fileCompressor.errorCompressing")} ${e.message}`)}finally{f(!1)}},R=()=>{u([]),d(null),p(null),b(""),l("")};return t.jsxs("div",{className:"relative bg-white p-6 rounded-lg shadow-md dark:bg-gray-800",children:[c&&t.jsx(M,{text:s("components.fileCompressor.compressing")}),t.jsx("input",{type:"file",multiple:!0,onChange:D,className:"hidden",ref:y}),t.jsxs("div",{onDrop:B,onDragOver:L,onDragLeave:O,className:`flex flex-col items-center justify-center p-10 border-2 border-dashed rounded-lg transition-colors ${w?"border-purple-600 bg-purple-50 dark:bg-gray-700":"border-gray-300 dark:border-gray-600"}`,children:[t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:s("components.fileCompressor.dragAndDrop")}),t.jsx("button",{onClick:()=>y.current?.click(),disabled:c,className:"w-auto bg-purple-600 text-white font-bold py-2 px-4 rounded-md hover:bg-purple-700 transition-colors disabled:bg-purple-400 dark:disabled:bg-purple-800",children:s("components.fileCompressor.selectFiles")})]}),t.jsx("div",{className:"mt-4 mb-4",children:t.jsxs("fieldset",{className:"flex space-x-4 justify-center",children:[t.jsx("legend",{className:"sr-only",children:s("components.fileCompressor.outputFormat")}),t.jsxs("div",{children:[t.jsx("input",{type:"radio",id:"zipFormat",name:"outputFormat",value:"zip",checked:g==="zip",onChange:()=>C("zip"),className:"h-4 w-4 text-purple-600 border-gray-300 focus:ring-purple-500 dark:border-gray-600"}),t.jsx("label",{htmlFor:"zipFormat",className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:".ZIP"})]})]})}),x&&t.jsx("p",{className:"text-red-500 mt-4 text-center",children:x}),a.length>0&&t.jsxs("div",{className:`mt-6 text-center ${c?"opacity-20":""}`,children:[t.jsx("h3",{className:"text-lg font-semibold dark:text-gray-200",children:s("components.fileCompressor.selectedFilesTitle")}),t.jsx("ul",{className:"text-left list-disc list-inside bg-gray-50 dark:bg-gray-700 p-4 rounded-md my-4 max-h-48 overflow-y-auto",children:a.map((e,r)=>t.jsxs("li",{className:"text-sm text-gray-700 dark:text-gray-300 truncate",children:[e.name," (",N(e.size),")"]},r))}),t.jsxs("div",{className:"flex justify-center space-x-4",children:[t.jsx("button",{onClick:P,disabled:c,className:"w-auto bg-green-500 text-white font-bold py-2 px-6 rounded-md hover:bg-green-600 transition-colors disabled:bg-green-300 dark:disabled:bg-green-800",children:s("components.fileCompressor.compressButton")}),t.jsx("button",{onClick:R,className:"w-auto bg-gray-500 text-white font-bold py-2 px-6 rounded-md hover:bg-gray-600 transition-colors",children:s("components.fileCompressor.clear")})]}),h&&t.jsxs("div",{className:"mt-6",children:[t.jsx("p",{className:"text-lg font-semibold dark:text-gray-200",children:s("components.fileCompressor.compressedFileReadyTitle")}),t.jsx("p",{className:"font-bold text-green-600 dark:text-green-400",children:N(F)}),t.jsx("a",{href:h,download:v,className:"mt-4 inline-block bg-blue-500 text-white font-bold py-2 px-8 rounded-md hover:bg-blue-600 transition-colors",children:s("components.fileCompressor.download")})]})]})]})};export{K as default};
