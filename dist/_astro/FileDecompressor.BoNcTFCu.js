import{j as t}from"./jsx-runtime.D3GSbgeI.js";import{r as y}from"./index.yGrMsBkE.js";import{J as P}from"./jszip.min.BEB7njDc.js";import{g as A}from"./_commonjsHelpers.Cpj98o6Y.js";import{L as C}from"./LoadingSpinner.Dvz2bPl4.js";import{u as E}from"./utils.BtV3MdL8.js";import"./index.yBjzXJbu.js";var U={exports:{}},L=U.exports,N;function I(){return N||(N=1,(function(j,i){(function(v,g){j.exports=g()})(L,function(){function v(n){function b(r){for(var s=0,m=l.length;s<m;++s)l[s](r);f.push(r)}if(typeof Promise!="function")throw new Error("Promise implementation not available in this environment.");var l=[],f=[],a=new Promise(function(r,s){n(r,s,b)});a.progress=function(r){if(typeof r!="function")throw new Error("cb is not a function.");for(var s=0,m=f.length;s<m;++s)r(f[s]);return l.push(r),a};var d=a.then;return a.then=function(r,s,m){return d.call(a,r,s),m!==void 0&&a.progress(m),a},a}function g(n){if(!(n instanceof ArrayBuffer))throw new TypeError("arrayBuffer is not an instance of ArrayBuffer.");if(!u.Worker)throw new Error("Worker implementation is not available in this environment.");return new v(function(b,l,f){var a=new Worker(p),d=[];a.onerror=function(r){l(r)},a.onmessage=function(r){switch(r=r.data,r.type){case"log":console[r.data.level]("Worker: "+r.data.msg);break;case"extract":var s=w(r.data);d.push(s),f(s);break;case"complete":a.terminate(),b(d);break;case"error":a.terminate(),l(new Error(r.data.message));break;default:a.terminate(),l(new Error("Unknown message from worker: "+r.type))}},a.postMessage({type:"extract",buffer:n},[n])})}function w(n){return Object.defineProperties(n,S),n}var p,u=window||this,k=u.URL||u.webkitURL,S={blob:{get:function(){return this._blob||(this._blob=new Blob([this.buffer]))}},getBlobUrl:{value:function(){return this._blobUrl||(this._blobUrl=k.createObjectURL(this.blob))}},readAsString:{value:function(){for(var n=this.buffer,b=n.byteLength,l=1,f=new DataView(n),a=[],d=0;d<b;++d){var r=f.getUint8(d*l,!0);a.push(r)}return this._string=String.fromCharCode.apply(null,a)}},readAsJSON:{value:function(){return JSON.parse(this.readAsString())}}};return p=(window||this).URL.createObjectURL(new Blob(['"use strict";function UntarWorker(){}function decodeUTF8(e){for(var r="",t=0;t<e.length;){var a=e[t++];if(a>127){if(a>191&&a<224){if(t>=e.length)throw"UTF-8 decode: incomplete 2-byte sequence";a=(31&a)<<6|63&e[t]}else if(a>223&&a<240){if(t+1>=e.length)throw"UTF-8 decode: incomplete 3-byte sequence";a=(15&a)<<12|(63&e[t])<<6|63&e[++t]}else{if(!(a>239&&a<248))throw"UTF-8 decode: unknown multibyte start 0x"+a.toString(16)+" at index "+(t-1);if(t+2>=e.length)throw"UTF-8 decode: incomplete 4-byte sequence";a=(7&a)<<18|(63&e[t])<<12|(63&e[++t])<<6|63&e[++t]}++t}if(a<=65535)r+=String.fromCharCode(a);else{if(!(a<=1114111))throw"UTF-8 decode: code point 0x"+a.toString(16)+" exceeds UTF-16 reach";a-=65536,r+=String.fromCharCode(a>>10|55296),r+=String.fromCharCode(1023&a|56320)}}return r}function PaxHeader(e){this._fields=e}function TarFile(){}function UntarStream(e){this._bufferView=new DataView(e),this._position=0}function UntarFileStream(e){this._stream=new UntarStream(e),this._globalPaxHeader=null}if(UntarWorker.prototype={onmessage:function(e){try{if("extract"!==e.data.type)throw new Error("Unknown message type: "+e.data.type);this.untarBuffer(e.data.buffer)}catch(r){this.postError(r)}},postError:function(e){this.postMessage({type:"error",data:{message:e.message}})},postLog:function(e,r){this.postMessage({type:"log",data:{level:e,msg:r}})},untarBuffer:function(e){try{for(var r=new UntarFileStream(e);r.hasNext();){var t=r.next();this.postMessage({type:"extract",data:t},[t.buffer])}this.postMessage({type:"complete"})}catch(a){this.postError(a)}},postMessage:function(e,r){self.postMessage(e,r)}},"undefined"!=typeof self){var worker=new UntarWorker;self.onmessage=function(e){worker.onmessage(e)}}PaxHeader.parse=function(e){for(var r=new Uint8Array(e),t=[];r.length>0;){var a=parseInt(decodeUTF8(r.subarray(0,r.indexOf(32)))),n=decodeUTF8(r.subarray(0,a)),i=n.match(/^\\d+ ([^=]+)=(.*)\\n$/);if(null===i)throw new Error("Invalid PAX header data format.");var s=i[1],o=i[2];0===o.length?o=null:null!==o.match(/^\\d+$/)&&(o=parseInt(o));var f={name:s,value:o};t.push(f),r=r.subarray(a)}return new PaxHeader(t)},PaxHeader.prototype={applyHeader:function(e){this._fields.forEach(function(r){var t=r.name,a=r.value;"path"===t?(t="name",void 0!==e.prefix&&delete e.prefix):"linkpath"===t&&(t="linkname"),null===a?delete e[t]:e[t]=a})}},UntarStream.prototype={readString:function(e){for(var r=1,t=e*r,a=[],n=0;n<e;++n){var i=this._bufferView.getUint8(this.position()+n*r,!0);if(0===i)break;a.push(i)}return this.seek(t),String.fromCharCode.apply(null,a)},readBuffer:function(e){var r;if("function"==typeof ArrayBuffer.prototype.slice)r=this._bufferView.buffer.slice(this.position(),this.position()+e);else{r=new ArrayBuffer(e);var t=new Uint8Array(r),a=new Uint8Array(this._bufferView.buffer,this.position(),e);t.set(a)}return this.seek(e),r},seek:function(e){this._position+=e},peekUint32:function(){return this._bufferView.getUint32(this.position(),!0)},position:function(e){return void 0===e?this._position:void(this._position=e)},size:function(){return this._bufferView.byteLength}},UntarFileStream.prototype={hasNext:function(){return this._stream.position()+4<this._stream.size()&&0!==this._stream.peekUint32()},next:function(){return this._readNextFile()},_readNextFile:function(){var e=this._stream,r=new TarFile,t=!1,a=null,n=e.position(),i=n+512;switch(r.name=e.readString(100),r.mode=e.readString(8),r.uid=parseInt(e.readString(8)),r.gid=parseInt(e.readString(8)),r.size=parseInt(e.readString(12),8),r.mtime=parseInt(e.readString(12),8),r.checksum=parseInt(e.readString(8)),r.type=e.readString(1),r.linkname=e.readString(100),r.ustarFormat=e.readString(6),r.ustarFormat.indexOf("ustar")>-1&&(r.version=e.readString(2),r.uname=e.readString(32),r.gname=e.readString(32),r.devmajor=parseInt(e.readString(8)),r.devminor=parseInt(e.readString(8)),r.namePrefix=e.readString(155),r.namePrefix.length>0&&(r.name=r.namePrefix+"/"+r.name)),e.position(i),r.type){case"0":case"":r.buffer=e.readBuffer(r.size);break;case"1":break;case"2":break;case"3":break;case"4":break;case"5":break;case"6":break;case"7":break;case"g":t=!0,this._globalPaxHeader=PaxHeader.parse(e.readBuffer(r.size));break;case"x":t=!0,a=PaxHeader.parse(e.readBuffer(r.size))}void 0===r.buffer&&(r.buffer=new ArrayBuffer(0));var s=i+r.size;return r.size%512!==0&&(s+=512-r.size%512),e.position(s),t&&(r=this._readNextFile()),null!==this._globalPaxHeader&&this._globalPaxHeader.applyHeader(r),null!==a&&a.applyHeader(r),r}};'])),g})})(U)),U.exports}var R=I();const T=A(R),J=({lang:j})=>{const i=E(j),[v,g]=y.useState(null),[w,p]=y.useState([]),[u,k]=y.useState(!1),[S,n]=y.useState(null),[b,l]=y.useState(!1),f=y.useRef(null),a=e=>{if(e===0)return"0 Bytes";const o=1024,c=["Bytes","KB","MB","GB"],h=Math.floor(Math.log(e)/Math.log(o));return parseFloat((e/Math.pow(o,h)).toFixed(2))+" "+c[h]},d=y.useCallback(async e=>{g(e),k(!0),n(null),p([]);try{if(e.name.endsWith(".zip")){const c=await new P().loadAsync(e),h=[];for(const x in c.files){const D=c.files[x],_=D.dir?null:await D.async("blob");h.push({name:x,isDirectory:D.dir,size:_?_.size:0,blob:_})}p(h)}else if(e.name.endsWith(".tar")){const o=await e.arrayBuffer(),c=await T(o),h=[];c.forEach(x=>{h.push({name:x.name,isDirectory:x.type==="directory",size:x.size||0,blob:x.blob||null})}),p(h)}else{n(i("components.fileDecompressor.errorInvalidArchive")),g(null),p([]);return}}catch{n(i("components.fileDecompressor.errorReadingArchive"))}finally{k(!1)}},[i]),r=e=>{const o=e.target.files?.[0];o&&d(o)},s=e=>{e.preventDefault(),e.stopPropagation(),l(!1);const o=e.dataTransfer.files?.[0];o&&d(o)},m=e=>{e.preventDefault(),e.stopPropagation(),l(!0)},F=e=>{e.preventDefault(),e.stopPropagation(),l(!1)},z=e=>{if(e.blob&&!e.isDirectory){const o=URL.createObjectURL(e.blob),c=document.createElement("a");c.href=o,c.download=e.name.split("/").pop()||"arquivo",document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(o)}},B=()=>{g(null),p([]),n(null)};return t.jsxs("div",{className:"relative bg-white p-6 rounded-lg shadow-md dark:bg-gray-800",children:[u&&t.jsx(C,{text:i("components.fileDecompressor.readingArchive")}),t.jsx("input",{type:"file",accept:".zip,.tar,application/zip,application/x-tar",onChange:r,className:"hidden",ref:f,disabled:u}),!v&&t.jsxs("div",{onDrop:s,onDragOver:m,onDragLeave:F,className:`flex flex-col items-center justify-center p-10 border-2 border-dashed rounded-lg transition-colors ${b?"border-purple-600 bg-purple-50 dark:bg-gray-700":"border-gray-300 dark:border-gray-600"}`,children:[t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:i("components.fileDecompressor.dragAndDrop")}),t.jsx("button",{onClick:()=>f.current?.click(),disabled:u,className:"w-auto bg-purple-600 text-white font-bold py-2 px-4 rounded-md hover:bg-purple-700 transition-colors disabled:bg-purple-400 dark:disabled:bg-purple-800",children:i("components.fileDecompressor.selectArchive")})]}),S&&t.jsx("p",{className:"mt-4 text-center text-red-500",children:S}),w.length>0&&t.jsxs("div",{className:`mt-6 ${u?"opacity-20":""}`,children:[t.jsx("h2",{className:"text-xl font-semibold mb-2 dark:text-gray-200",children:i("components.fileDecompressor.fileContents")}),t.jsx("div",{className:"border rounded-lg dark:border-gray-600 max-h-96 overflow-y-auto",children:t.jsxs("table",{className:"w-full text-left",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"p-3 text-sm font-semibold text-gray-600 dark:text-gray-300",children:i("components.fileDecompressor.fileName")}),t.jsx("th",{className:"p-3 text-sm font-semibold text-gray-600 dark:text-gray-300",children:i("components.fileDecompressor.size")}),t.jsx("th",{className:"p-3 text-sm font-semibold text-gray-600 dark:text-gray-300",children:i("components.fileDecompressor.action")})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:w.map(e=>t.jsxs("tr",{children:[t.jsx("td",{className:"p-3 text-sm text-gray-800 dark:text-gray-200",children:e.name}),t.jsx("td",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:e.isDirectory?i("components.fileDecompressor.folder"):a(e.size)}),t.jsx("td",{className:"p-3",children:!e.isDirectory&&t.jsx("button",{onClick:()=>z(e),className:"text-blue-500 hover:underline text-sm",children:i("components.fileDecompressor.download")})})]},e.name))})]})}),t.jsx("button",{onClick:B,className:"w-full mt-4 text-sm text-gray-500 hover:text-purple-600 dark:text-gray-400 dark:hover:text-purple-400",children:i("components.fileDecompressor.selectAnother")})]})]})};export{J as default};
