import{j as e}from"./jsx-runtime.3a2d0367.js";import{r}from"./index.b2a7ed32.js";import{L as M}from"./LoadingSpinner.d3c04f9a.js";import{u as q}from"./utils.b058de7b.js";const T=({lang:F})=>{const t=q(F),[n,g]=r.useState(null),[v,p]=r.useState(""),[u,x]=r.useState(""),[i,L]=r.useState(.7),[d,h]=r.useState(null),[b,f]=r.useState(null),[N,m]=r.useState(""),[l,j]=r.useState(!1),[B,y]=r.useState(!1),w=r.useRef(null),C=s=>{s&&s.type.startsWith("image/")?(g(s),p(URL.createObjectURL(s)),h(s.size),x(""),f(null),m("")):s?(m(t("components.imageCompressor.errorInvalidFile")),g(null),p(""),h(null)):(g(null),p(""),h(null),m(""))},I=s=>{C(s.target.files?.[0]||null)},R=s=>{s.preventDefault(),s.stopPropagation(),y(!1),C(s.dataTransfer.files?.[0]||null)},U=s=>{s.preventDefault(),s.stopPropagation(),y(!0)},O=s=>{s.preventDefault(),s.stopPropagation(),y(!1)},z=r.useCallback(()=>{if(!n)return;j(!0),x(""),f(null);const s=new FileReader;s.onload=c=>{const a=new Image;a.onload=()=>{const o=document.createElement("canvas");o.width=a.width,o.height=a.height;const D=o.getContext("2d");if(!D){m(t("components.imageCompressor.errorCanvas")),j(!1);return}D.drawImage(a,0,0),o.toBlob(k=>{k&&(x(URL.createObjectURL(k)),f(k.size)),j(!1)},"image/jpeg",i)},a.src=c.target?.result},s.readAsDataURL(n)},[n,i,t]),S=s=>{if(s===null||s===0)return"0 Bytes";const c=1024,a=["Bytes","KB","MB","GB"],o=Math.floor(Math.log(s)/Math.log(c));return parseFloat((s/Math.pow(c,o)).toFixed(2))+" "+a[o]};return e.jsxs("div",{className:"relative bg-white p-6 rounded-lg shadow-md dark:bg-gray-800",children:[l&&e.jsx(M,{text:t("components.imageCompressor.compressing")}),e.jsx("input",{type:"file",accept:"image/jpeg, image/png, image/webp",onChange:I,className:"hidden",ref:w}),!n&&e.jsxs("div",{onDrop:R,onDragOver:U,onDragLeave:O,className:`flex flex-col items-center justify-center p-10 border-2 border-dashed rounded-lg transition-colors ${B?"border-purple-600 bg-purple-50 dark:bg-gray-700":"border-gray-300 dark:border-gray-600"}`,children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:t("components.imageCompressor.dragAndDrop")}),e.jsx("button",{onClick:()=>w.current?.click(),disabled:l,className:"w-auto bg-purple-600 text-white font-bold py-2 px-4 rounded-md hover:bg-purple-700 transition-colors disabled:bg-purple-400 dark:disabled:bg-purple-800",children:t("components.imageCompressor.selectImage")})]}),N&&e.jsx("p",{className:"text-red-500 mt-4 text-center",children:N}),n&&e.jsxs("div",{className:l?"opacity-20":"",children:[e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{htmlFor:"quality",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[t("components.imageCompressor.quality"),": ",Math.round(i*100),"%"]}),e.jsx("input",{type:"range",id:"quality",min:"0.1",max:"1",step:"0.05",value:i,onChange:s=>L(parseFloat(s.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-purple-600",disabled:l})]}),e.jsx("button",{onClick:z,disabled:l,className:"w-full bg-green-500 text-white font-bold py-2 px-4 rounded-md hover:bg-green-600 transition-colors disabled:bg-green-300 dark:disabled:bg-green-800",children:t("components.imageCompressor.compressButton")}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mt-6 text-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold dark:text-gray-200",children:t("components.imageCompressor.original")}),v&&e.jsx("img",{src:v,alt:"Original",className:"mt-2 rounded-lg shadow-sm mx-auto max-h-80"}),e.jsx("p",{className:"mt-2 font-medium text-gray-700 dark:text-gray-300",children:S(d)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold dark:text-gray-200",children:t("components.imageCompressor.compressed")}),u?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:u,alt:"Comprimida",className:"mt-2 rounded-lg shadow-sm mx-auto max-h-80"}),e.jsxs("p",{className:"mt-2 font-bold text-green-600 dark:text-green-400",children:[S(b),d&&b&&e.jsxs("span",{className:"text-sm text-gray-500 ml-2 dark:text-gray-400",children:["(",((d-b)/d*100).toFixed(0),"% ",t("components.imageCompressor.reduction"),")"]})]}),e.jsx("a",{href:u,download:`${t("components.imageCompressor.downloadPrefix")}-${n.name}`,className:"mt-4 inline-block bg-blue-500 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-600 transition-colors disabled:bg-blue-300 dark:disabled:bg-blue-800",children:t("components.imageCompressor.download")})]}):e.jsx("div",{className:"mt-2 flex items-center justify-center h-80 bg-gray-100 rounded-lg dark:bg-gray-700",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t("components.imageCompressor.waiting")})})]})]})]}),e.jsx("button",{onClick:()=>C(null),className:"w-full mt-4 text-sm text-gray-500 hover:text-purple-600 dark:text-gray-400 dark:hover:text-purple-400",children:t("components.imageCompressor.selectAnother")})]})]})};export{T as default};
